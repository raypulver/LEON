!function(t,r){"use strict";"function"==typeof define&&define.amd?define(r):"object"==typeof exports?module.exports=r():t.LEON=r()}(this,function(){"use strict";function t(t){return function(){return Function.call.apply(t,arguments)}}function r(t){var r=g(null);return t&&w(E(t),function(e){r[e]=t[e]}),r}function e(t){for(var r=0;r<nt.checkers.length;++r)if(t===nt.checkers[r].constant)return void nt.checkers.splice(r,1)}function n(t,i){if("number"!=typeof t)throw TypeError("Constant must be numeric.");if(0>t||t>255)throw RangeError("Constant must be between 0 and 255.");"object"!=typeof i&&(i={}),nt.types[t]||(nt.types[t]=r({})),"function"==typeof i.check&&(e(t),nt.checkers.push(r({constant:t,detect:i.check}))),"function"==typeof i.encode&&(nt.types[t].encode=i.encode),"function"==typeof i.decode&&(nt.types[t].decode=i.decode),"string"==typeof i.name&&(nt.types[t].name="string")}function s(t,r){return this instanceof s?(this.r=t,void(this.i=r)):new s(t,r)}function h(t,r){return this instanceof h?(this.p=t,void(this.q=r)):new h(t,r)}function o(t){if("object"==typeof t)return tt(t)?t.object?"OBJECT":"ARRAY":"OBJECT";if(t===F)return"ARRAY";if(t===N)return"OBJECT";if(nt.types[t])return nt.types[t].name?nt.types[t].name:"custom unnamed";for(var r=E(it),e=0;e<r.length;++e)if(it[r[e]]===t)return r[e];return"unknown type"}function u(t){if("object"!=typeof t)throw TypeError("Argument must be an object");var r=function(e){return w(E(e),function(t){this[t]=e[t]},t),r};return r}function a(t,r){return r>=32?-t:((1<<r)-1^t)+1}var f,c,l,p=Array,d=p.prototype,w=t(d.forEach),b=Object,g=b.create||function(t){function r(){return this}return r.prototype=t,new r},E=b.keys||function(t){var r,e=[];for(r in t)t.hasOwnProperty(r)&&e.push(r);return e},y=this,I=y&&y.LEON,v=65536,U=255,L=254,T=253,m=252,M=251,B=250,S=249,A=248,F=246,N=245,D=244,x=244,R=243,V=243,O=242,j=240,C=239,_=238,W=237,k=236,Y=235,G=231,P=230,J=228,X=227,q=225,z=221,H=220,K=b.prototype,Q=String,Z=String.fromCharCode,$=y&&y.toString||K.toString,tt=p.isArray||function(t){return"[object Array]"===$.call(t)},rt=b.getOwnPropertyNames||E,et=t(d.reduce||function(t,r,e){var i;for(i=0;i<this.length;++i)r=t.call(e,r,this[i],i,this);return r}),w=t(d.forEach),it=r({UINT8:U,INT8:L,UINT16:T,INT16:m,UINT32:M,INT32:B,FLOAT:S,DOUBLE:A,STRING:D,UTF8STRING:x,UTF16STRING:H,BOOLEAN:R,DATE:_,BUFFER:W,REGEXP:k,COMPLEX:X,RATIONAL:J,SYMBOL:q,DYNAMIC:z}),nt=r({types:new p(256),checkers:[]});if(l=function(){try{return new Uint8Array(4),!0}catch(t){return f=!1,c=null,!1}}()){var st=Uint8Array,ht=ArrayBuffer,ot=new ht(4),ut=new st(ot),at=new Float32Array(ot),ft=new ht(8),ct=new st(ft),lt=new Float64Array(ft);if(f=function(){try{return new Buffer(4),!0}catch(t){return!1}}())var pt=Buffer,dt=pt.isBuffer;c=function(){var t=new ht(2),r=new st(t),e=new Uint16Array(t);return e[0]=1,!!r[0]}()}var wt={},bt="function"==typeof Symbol?Symbol:function(t){return wt[t]||(wt[t]={toString:function(){return t}}),wt[t]};return function(){function t(t){return"[object RegExp]"===$.call(t)}function r(t,r,e){switch(r){case U:case T:case M:case A:break;default:throw TypeError("Was expecting a numeric type at "+Q(e.position)+" to read length of "+o(t)+" but instead got "+o(r)+".")}}function e(t){var e,i,n,s;if(t instanceof mt&&(t=t.sorted),void 0===t||t===z)return d.call(this);if(t===D)return this.readStringUTF8();if("object"!=typeof t)return t===R?d.call(this):b.call(this,t);if(tt(t)){if(0===t.length)return b.call(this,F);if(t.object){for(e={},i=0;i<t.length;++i)e[t[i].key]=this.readValue(t[i].type);return e}if(t.length>1){for(e=new p(n),i=0;n>i;++i)e[i]=this.readValue(t[i]);return e}for(s=this.readUInt8(),r(t,s,this),n=this.readValue(s),e=new p(n),i=0;n>i;++i)e[i]=this.readValue(t[0]);return e}}function d(){return b.call(this,this.readUInt8())}function b(t){var e,i,n,o,u;if(nt.types[t]){if(!nt.types[t].decode)throw Error("Tried to decode a custom type for which there is no defined decode function.");return this.offset+=this.position,this.position=0,nt.types[t].decode(this)}switch(t){case U:return this.readUInt8();case L:return this.readInt8();case T:return this.readUInt16LE();case m:return this.readInt16LE();case M:return this.readUInt32LE();case B:return this.readInt32LE();case S:return this.readFloatLE();case A:return this.readDoubleLE();case F:for(u=this.readUInt8(),r(t,u,this),e=this.readValue(u),n=new p(e),i=0;e>i;++i)n[i]=this.readValue();return n;case N:for(n={},u=this.readUInt8(),r(t,u,this),e=this.readValue(u),i=0;e>i;++i)o=this.readStringUTF8(),n[o]=this.readValue();break;case x:return this.readStringUTF8();case H:return this.readStringUTF16();case z:return this.readValue();case C:return;case V:return!0;case O:return!1;case j:return null;case Y:return NaN;case P:return Number.NEGATIVE_INFINITY;case G:return Number.POSITIVE_INFINITY;case _:return new Date(this.readDoubleLE());case W:if(u=this.readUInt8(),r(t,u,this),e=this.readValue(u),f)for(n=new pt(e),i=0;e>i;++i)n[i]=this.readUInt8();else{n=new ht(e);var a=new st(n);for(i=0;e>i;++i)a[i]=this.readUInt8()}return n;case k:return RegExp(this.readStringUTF8(),ft(this.readUInt8()));case q:return bt(this.readStringUTF8());case X:return s(this.readDouble(),this.readDouble());case J:return h(this.readDouble(),this.readDouble());default:throw Error("Parsed invalid LEON constant: "+Q(t))}return n}function g(t,r){if(t.position+t.offset+r>t.buffer.uchars.length)throw RangeError("Tried to read past end of buffer at position "+(t.position+t.offset)+".")}function y(t,r,e){return this instanceof y?(this.buffer=Nt(t),"number"==typeof r&&r>0?this.offset=r:this.offset=0,void("number"==typeof e&&e>0?this.position=e:this.position=0)):new y(t,r,e)}function K(t,r){var e,i,n=typeof t;for(e=0;e<nt.checkers.length;++e)if(nt.checkers[e].detect(t))return nt.checkers[e].constant;switch(n){case"object":if(null===t)return j;if(tt(t))return F;switch(i=$.call(t)){case"[object Date]":return _;case"[object RegExp]":return k;default:return xt(t)?W:t instanceof s?X:t instanceof h?J:t instanceof Symbol?q:N}case"boolean":return t?V:O;case"string":return D;case"number":return t!==t?Y:t===Number.NEGATIVE_INFINITY?P:t===Number.POSITIVE_INFINITY?G:t%1||r?Rt(t):0>t?Math.abs(t)<=128?L:Math.abs(t)<=32768?m:Math.abs(t)<=Math.pow(2,31)?B:A:256>t?U:65536>t?T:t<Math.pow(2,32)?M:A;case"undefined":case"function":return C;case"symbol":return q}}function ot(t,r){return this instanceof ot?(this.payload=t,this.iterator=y(),this.spec=r,this.state=0,void Ot.call(this)):new ot(t,r)}function ft(t){switch(typeof t){case"string":case"undefined":var r=0;return~t.indexOf("i")&&(r|=1),~t.indexOf("g")&&(r|=2),~t.indexOf("m")&&(r|=4),r;case"number":var r="";return 1&t&&(r+="i"),2&t&&(r+="g"),4&t&&(r+="m"),r}}function wt(t){return t=t.toString(),[t.substr(1,t.lastIndexOf("/")-1),t.substr(t.lastIndexOf("/")+1)]}function gt(t){var r=K(t[0]);switch(r){case U:case L:case T:case m:case M:case B:case S:case A:for(var e=Math.abs(t[0]),i=t[0]%1!==0,n=t[0]<0?1:0,s=1;s<t.length;++s){if("number"!=typeof t[s])return z;Math.abs(t[s])>e&&(e=Math.abs(t[s])),t[s]%1!==0&&(i=!0),t[s]<0&&(n=1)}return K((n?-1:1)*e,i);case F:return[gt(et(t,function(t,r){return t.concat(r)},[]))];case N:var h={};return w(rt(t[0]),function(r){h[r]=gt(Et(t,r))}),h;default:r===O&&(r=V);for(var o,s=1;s<t.length;++s)if(o=K(t[s]),o===O&&(o=V),o!==r)return z;return r}}function Et(t,r){for(var e=[],i=0;i<t.length;++i){if("object"!=typeof t[i])throw Error("Received a non-object value when an object was expected.");if("undefined"==typeof t[i][r])throw Error("Object "+JSON.stringify(t[i])+" has no property "+Q(r)+".");e.push(t[i][r])}return e}function yt(t){var r=K(t);switch(r){case F:return[gt(t)];case N:var e={};return w(rt(t),function(r){e[r]=yt(t[r])}),e;case O:return V;default:return r}}function It(t,r){return y(t).readValue()}function vt(t,r){return ot(t).writeData().toBuffer()}function Ut(t){return/^[0-9]/.test(t)||/[^\w_]/.test(t)?!0:!1}function Lt(t,r){for(var e=0,i=rt(t);e<i.length;++e)if(t[i[e]]===r)return!0;return!1}function Tt(t,r){var e;switch("undefined"==typeof r&&(r="{Template}"),typeof t){case"number":if(!Lt(it,t))throw Error(r+" is not a valid type constant.");break;case"function":throw Error(r+" is a function.");case"boolean":throw Error(r+" is a boolean.");case"undefined":throw Error(r+" is undefined. Did you misspell a type constant?");case"string":throw Error(r+" is a string.");case"object":if(t instanceof mt)break;if("[object Date]"===$.call(t))throw Error(r+" is a Date object. Did you mean to supply LEON.DATE?");if("[object RegExp]"===$.call(t))throw Error(r+" is a RegExp. Did you mean to supply LEON.REGEXP?");if(tt(t)){if(0===t.length)throw Error(r+" is an array with no elements, must contain at least one.");for(var i=0;i<t.length;++i)Tt(t[i],r+"["+String(i)+"]")}else for(var i=0,n=rt(t);i<n.length;++i)e=Ut(t),Tt(t[n[i]],r+(e?"['"+n[i]+"']":"."+n[i]))}}function mt(t){return this instanceof mt?(Tt(t),this.spec=t,void(this.sorted=function r(t){if("object"==typeof t){if(t instanceof mt)return t.sorted;if(tt(t))return t.map(r);var e=[],i=rt(t);i.sort(function(t,r){return t>r});for(var n=0;n<i.length;++n)e.push({key:i[n],type:r(t[i[n]])});return e.object=!0,e}return t}(t))):new mt(t)}function Mt(t,r){for(var e="",i=0;r>i;++i)e+=t;return e}function Bt(t,r){return Ut(t)?(r?"[32m":"")+"'"+t+"'"+(r?"[m":""):t}var St=function(){var t;return t=l?function(t){"undefined"==typeof t&&(t=this.buffer.byteLength<<1);var r=this.buffer;this.buffer=new ht(t);var e=new st(r),i=new st(this.buffer);return i.set(e,0),this.uchars=new st(this.buffer),this.chars=new Int8Array(this.buffer),this}:function(t){return void 0===t&&(t=this.buffer.length<<1),this.buffer.length=t,this},function(){this._realloc=t}}(),At=function(){function t(t,r){return 0>t&&(t=a(-t,16)),this.writeUInt16LE(t,r)}function r(t,r){return 0>t&&(t=a(-t,16)),this.writeUInt16BE(t,r)}function e(t,r){return 0>t&&(t=a(-t,32)),this.writeUInt32LE(t,r)}function i(t,r){return 0>t&&(t=a(-t,32)),this.writeUInt32BE(t,r)}function n(t){return this.uchars[t]}function s(t){return this.uchars[t+1]<<8|this.uchars[t]}function h(t){return this.uchars[t]<<8|this.uchars[t+1]}function o(t){var r=this.readUInt16LE(t);return 32768&r?-a(r,16):r}function u(t){var r=this.readUInt16BE(t);return 32768&r?-a(r,16):r}function f(t){return this.uchars[t+3]<<24|this.uchars[t+2]<<16|this.uchars[t+1]<<8|this.uchars[t]}function p(t){return this.uchars[t]<<24|this.uchars[t+1]<<16|this.uchars[t+2]<<8|this.uchars[t+3]}function d(t){var r=this.readUInt32LE(t);return 0>r?r:2147483648&r?-a(r,32):r}function w(t){var r=this.readUInt32BE(t);return 0>r?r:2147483648&r?-a(r,32):r}var b,g,E,y,I,v,U,L,T,m,M,B,S,A,F;return l?(v=function(t,r){return r>=this.buffer.byteLength&&this._realloc(),this.uchars[r]=t,this},b=function(t,r){return r>=this.buffer.byteLength&&this._realloc(),this.chars[r]=t,this},U=function(t,r){return r>=this.buffer.byteLength-1&&this._realloc(),this.uchars[r]=255&t,this.uchars[r+1]=t>>>8,this},L=function(t,r){return r>=this.buffer.byteLength-1&&this._realloc(),this.uchars[r]=t>>>8,this.uchars[r+1]=255&t,this},T=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),this.uchars[r]=255&t,this.uchars[r+1]=t>>>8&255,this.uchars[r+2]=t>>>16&255,this.uchars[r+3]=t>>>24,this},m=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),this.uchars[r+3]=255&t,this.uchars[r+2]=t>>>8&255,this.uchars[r+1]=t>>>16&255,this.uchars[r]=t>>>24,this},M=function(t){return this.chars[t]},c?(g=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),at[0]=t,this.uchars.set(ut,r),this},E=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),at[0]=t,this.uchars[r]=ut[3],this.uchars[r+1]=ut[2],this.uchars[r+2]=ut[1],this.uchars[r+3]=ut[0],this},y=function(t,r){return r>=this.buffer.byteLength-7&&this._realloc(),lt[0]=t,this.uchars.set(ct,r),this},I=function(t,r){return r>=this.buffer.byteLength-7&&this._realloc(),lt[0]=t,this.uchars[r]=ct[7],this.uchars[r+1]=ct[6],this.uchars[r+2]=ct[5],this.uchars[r+3]=ct[4],this.uchars[r+4]=ct[3],this.uchars[r+5]=ct[2],this.uchars[r+6]=ct[1],this.uchars[r+7]=ct[0],this},B=function(t){return ut[0]=this.uchars[t],ut[1]=this.uchars[t+1],ut[2]=this.uchars[t+2],ut[3]=this.uchars[t+3],at[0]},S=function(t){return ut[0]=this.uchars[t+3],ut[1]=this.uchars[t+2],ut[2]=this.uchars[t+1],ut[3]=this.uchars[t+0],at[0]},A=function(t){return ct[0]=this.uchars[t],ct[1]=this.uchars[t+1],ct[2]=this.uchars[t+2],ct[3]=this.uchars[t+3],ct[4]=this.uchars[t+4],ct[5]=this.uchars[t+5],ct[6]=this.uchars[t+6],ct[7]=this.uchars[t+7],lt[0]},F=function(t){return ct[0]=this.uchars[t+7],ct[1]=this.uchars[t+6],ct[2]=this.uchars[t+5],ct[3]=this.uchars[t+4],ct[4]=this.uchars[t+3],ct[5]=this.uchars[t+2],ct[6]=this.uchars[t+1],ct[7]=this.uchars[t],lt[0]}):(g=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),at[0]=t,this.uchars[r]=ut[3],this.uchars[r+1]=ut[2],this.uchars[r+2]=ut[1],this.uchars[r+3]=ut[0],this},E=function(t,r){return r>=this.buffer.byteLength-3&&this._realloc(),at[0]=t,this.uchars[r]=ut[0],this.uchars[r+1]=ut[1],this.uchars[r+2]=ut[2],this.uchars[r+3]=ut[3],this},y=function(t,r){return r>=this.buffer.byteLength-7&&this._realloc(),lt[0]=t,this.uchars[r]=ct[7],this.uchars[r+1]=ct[6],this.uchars[r+2]=ct[5],this.uchars[r+3]=ct[4],this.uchars[r+4]=ct[3],this.uchars[r+5]=ct[2],this.uchars[r+6]=ct[1],this.uchars[r+7]=ct[0],this},I=function(t,r){return r>=this.buffer.byteLength-7&&this._realloc(),lt[0]=t,this.uchars[r]=ct[0],this.uchars[r+1]=ct[1],this.uchars[r+2]=ct[2],this.uchars[r+3]=ct[3],this.uchars[r+4]=ct[4],this.uchars[r+5]=ct[5],this.uchars[r+6]=ct[6],this.uchars[r+7]=ct[7],this},B=function(t){return ut[0]=this.uchars[t+3],ut[1]=this.uchars[t+2],ut[2]=this.uchars[t+1],ut[3]=this.uchars[t],at[0]},S=function(t){return ut[0]=this.uchars[t],ut[1]=this.uchars[t+1],ut[2]=this.uchars[t+2],ut[3]=this.uchars[t+3],at[0]},A=function(t){return ct[0]=this.uchars[t+7],ct[1]=this.uchars[t+6],ct[2]=this.uchars[t+5],ct[3]=this.uchars[t+4],ct[4]=this.uchars[t+3],ct[5]=this.uchars[t+2],ct[6]=this.uchars[t+1],ct[7]=this.uchars[t],lt[0]},F=function(t){return ct[0]=this.uchars[t],ct[1]=this.uchars[t+1],ct[2]=this.uchars[t+2],ct[3]=this.uchars[t+3],ct[4]=this.uchars[t+4],ct[5]=this.uchars[t+5],ct[6]=this.uchars[t+6],ct[7]=this.uchars[t+7],lt[0]})):(v=function(t,r){return r>=this.uchars.length&&this._realloc(),this.uchars[r]=t,this},b=function(t,r){0>t&&(t=a(-t,8)),this.writeUInt8(t,r)},U=function(t,r){return r>=this.uchars.length-1&&this._realloc(),this.uchars[r]=255&t,this.uchars[r+1]=t>>>8,this},L=function(t,r){return r>=this.uchars.length-1&&this._realloc(),this.uchars[r+1]=255&t,this.uchars[r]=t>>>8,this},T=function(t,r){return r>=this.uchars.length-3&&this._realloc(),this.uchars[r]=255&t,this.uchars[r+1]=t>>>8&255,this.uchars[r+2]=t>>>16&255,this.uchars[r+3]=t>>>24,this},m=function(t,r){return r>=this.uchars.length-3&&this._realloc(),this.uchars[r+3]=255&t,this.uchars[r+2]=t>>>8&255,this.uchars[r+1]=t>>>16&255,this.uchars[r]=t>>>24,this},g=function(t,r){var e,i,n=127;return e=0>t?1:0,t=Math.abs(t),i=Math.log(t)/Math.LN2,i=0>i?Math.ceil(i):Math.floor(i),t*=Math.pow(2,-i+23),n+=i,t=Math.round(t),t&=8388607,this.writeUInt8(255&t,r),this.writeUInt8(t>>8&255,r+1),this.writeUInt8((1&n)<<7|t>>16&127,r+2),this.writeUInt8(e<<7|(254&n)>>1,r+3),r+4},E=function(t,r){var e,i,n=127;return e=0>t?1:0,t=Math.abs(t),i=Math.log(t)/Math.LN2,i=0>i?Math.ceil(i):Math.floor(i),t*=Math.pow(2,-i+23),n+=i,t=Math.round(t),t&=8388607,this.writeUInt8(255&t,r+3),this.writeUInt8(t>>8&255,r+2),this.writeUInt8((1&n)<<7|t>>16&127,r+1),this.writeUInt8(e<<7|(254&n)>>1,r),r+4},y=function(t,r){var e,i,n=1023;e=0>t?1:0,t=Math.abs(t),i=Math.log(t)/Math.LN2,i=0>i?Math.ceil(i):Math.floor(i),t*=Math.pow(2,-i+52),n+=i,t=Math.round(t),t=parseInt(t.toString(2).substr(1),2);var s=[];s.push(e<<7),s[0]|=n>>4,s.push((15&n)<<4),s[1]|=15&Math.floor(t*Math.pow(2,-48));for(var h=40,o=0;6>o;++o)s.push(255&Math.floor(t*Math.pow(2,-h))),h-=8;for(o=7;o>=0;--o)this.writeUInt8(s[o],r+(7-o));return r+8},I=function(t,r){var e,i,n=1023;e=0>t?1:0,t=Math.abs(t),i=Math.log(t)/Math.LN2,i=0>i?Math.ceil(i):Math.floor(i),t*=Math.pow(2,-i+52),n+=i,t=Math.round(t),t=parseInt(t.toString(2).substr(1),2);var s=[];s.push(e<<7),s[0]|=n>>4,s.push((15&n)<<4),s[1]|=15&Math.floor(t*Math.pow(2,-48));for(var h=40,o=0;6>o;++o)s.push(255&Math.floor(t*Math.pow(2,-h))),h-=8;for(o=0;8>o;++o)this.writeUInt8(s[o],r+(7-o));return r+8},M=function(t){var r=this.uchars[t];return 128&r?-a(r,8):r},B=function(t){for(var r=[],e=3;e>=0;--e)r.push(this.readUInt8(t+e));var i=(128&r[0])>>7,n=(127&r[0])<<1|(128&r[1])>>7,s=0;r[1]&=127;for(var e=0;2>=e;++e)s|=r[e+1]*Math.pow(2,8*(2-e));return s|=8388608,(1===i?-s:s)*Math.pow(2,n-150)},S=function(t){for(var r=[],e=0;4>e;++e)r.push(this.readUInt8(t+e));var i=(128&r[0])>>7,n=(127&r[0])<<1|(128&r[1])>>7,s=0;r[1]&=127;for(var e=0;2>=e;++e)s|=r[e+1]*Math.pow(2,8*(2-e));return s|=8388608,(1===i?-s:s)*Math.pow(2,n-150)},A=function(t){for(var r=[],e=7;e>=0;--e)r.push(this.readUInt8(t+e));var i=(128&r[0])>>7,n=(127&r[0])<<4|(240&r[1])>>4,s=0;r[1]&=15;for(var e=0;6>=e;++e)s+=r[e+1]*Math.pow(2,8*(6-e));return s+=4503599627370496,(1===i?-s:s)*Math.pow(2,n-1075)},F=function(t){for(var r=[],e=0;8>e;++e)r.push(this.readUInt8(t+e));var i=(128&r[0])>>7,n=(127&r[0])<<4|(240&r[1])>>4,s=0;r[1]&=15;for(var e=0;6>=e;++e)s+=r[e+1]*Math.pow(2,8*(6-e));return s+=4503599627370496,(1===i?-s:s)*Math.pow(2,n-1075)}),function(){this.writeUInt8=v,this.writeInt8=b,this.writeUInt16LE=U,this.writeUInt16BE=L,this.writeInt16LE=t,this.writeInt16BE=r,this.writeUInt32LE=T,this.writeUInt32BE=m,this.writeInt32LE=e,this.writeInt32BE=i,this.writeFloatLE=g,this.writeFloatBE=E,this.writeDoubleLE=y,this.writeDoubleBE=I,this.readUInt8=n,this.readInt8=M,this.readUInt16LE=s,this.readUInt16BE=h,this.readInt16LE=o,this.readInt16BE=u,this.readUInt32LE=f,this.readUInt32BE=p,this.readInt32LE=d,this.readInt32BE=w,this.readFloatLE=B,this.readFloatBE=S,this.readDoubleLE=A,this.readDoubleBE=F}}(),Ft=function(t,r){return l?t:r}(function(t){for(var r=new ht(t.length),e=new st(r),i=0;i<t.length;++i)e[i]=t.charCodeAt(i);return r},function(t){for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t.charCodeAt(e);return r}),Nt=function(t,r,e){return f?t:l?r:e}(function Ct(t){if(!(this instanceof Ct))return new Ct(t);if("undefined"==typeof t&&(t=v),t instanceof ht)this.buffer=t;else if("string"==typeof t)this.buffer=Ft(t);else if(dt(t)){var r=t;t=new ht(r.length);for(var e=new st(t),i=0;i<r.length;++i)e[i]=r[i];this.buffer=t}else this.buffer=new ht(t);this.uchars=new st(this.buffer),this.chars=new Int8Array(this.buffer),At.call(this),St.call(this)},function _t(t){return this instanceof _t?("undefined"==typeof t&&(t=v),"string"==typeof t?this.buffer=Ft(t):t instanceof ht?this.buffer=t:this.buffer=new ht(t),this.uchars=new st(this.buffer),this.chars=new Int8Array(this.buffer),At.call(this),void St.call(this)):new _t(t)},function Wt(t){return this instanceof Wt?("undefined"==typeof t&&(t=v),tt(t)?this.buffer=t:"string"==typeof t?this.buffer=Ft(t):this.buffer=new p(t),this.uchars=this.buffer,At.call(this),void St.call(this)):new Wt(t)});Nt.concat=function(t,r){return l?t:r}(function(t){return Nt(et(t,function(t,r){var e=new st(t.buffer.byteLength+r.buffer.byteLength);return e.set(new st(t.buffer),0),e.set(new st(r.buffer),t.buffer.byteLength),e.buffer},new ht(0)))},function(t){return Nt(et(t,function(t,r){return t.concat(r.buffer)},[]))});var Dt=function(){function n(){return g(this,1),this.position++,this.buffer.readUInt8(this.offset+this.position-1)}function u(){return g(this,1),this.position++,this.buffer.readInt8(this.offset+this.position-1)}function a(){return g(this,2),this.position+=2,this.buffer.readUInt16LE(this.offset+this.position-2)}function c(){return g(this,2),this.position+=2,this.buffer.readUInt16BE(this.offset+this.position-2)}function p(){return g(this,2),this.position+=2,this.buffer.readInt16LE(this.offset+this.position-2)}function d(){return g(this,2),this.position+=2,this.buffer.readInt16BE(this.offset+this.position-2)}function w(){return g(this,4),this.position+=4,this.buffer.readUInt32LE(this.offset+this.position-4)}function b(){return g(this,4),this.position+=4,this.buffer.readUInt32BE(this.offset+this.position-4)}function y(){return g(this,4),this.position+=4,this.buffer.readInt32LE(this.offset+this.position-4)}function I(){return g(this,4),this.position+=4,this.buffer.readInt32BE(this.offset+this.position-4)}function v(){return g(this,4),this.position+=4,this.buffer.readFloatLE(this.offset+this.position-4)}function rt(){return g(this,4),this.position+=4,this.buffer.readFloatBE(this.offset+this.position-4)}function et(){return g(this,8),this.position+=8,this.buffer.readDoubleLE(this.offset+this.position-8)}function it(){return g(this,8),this.position+=8,this.buffer.readDoubleBE(this.offset+this.position-8)}function ot(t){t=unescape(encodeURIComponent(t)),this.writeValue(t.length);for(var r=0;r<t.length;++r)this.writeUInt8(t.charCodeAt(r));return this}function ut(t){this.writeValue(t.length);for(var r=0;r<t.length;++r)this.writeUInt16LE(t.charCodeAt(r));return this}function at(t){return this.buffer.writeUInt8(t,this.offset+this.position),++this.position,this}function ct(t){return this.buffer.writeInt8(t,this.offset+this.position),++this.position,this}function lt(t){return this.buffer.writeUInt16LE(t,this.offset+this.position),this.position+=2,this}function pt(t){return this.buffer.writeUInt16BE(t,this.offset+this.position),this.position+=2,this}function bt(t){return this.buffer.writeInt16LE(t,this.offset+this.position),this.position+=2,this}function gt(t){return this.buffer.writeInt16BE(t,this.offset+this.position),this.position+=2,this}function Et(t){return this.buffer.writeUInt32LE(t,this.offset+this.position),this.position+=4,this}function yt(t){return this.buffer.writeUInt32BE(t,this.offset+this.position),this.position+=4,this}function It(t){return this.buffer.writeInt32LE(t,this.offset+this.position),this.position+=4,this}function vt(t){return this.buffer.writeInt32BE(t,this.offset+this.position),this.position+=4,this}function Ut(t){return this.buffer.writeFloatLE(t,this.offset+this.position),this.position+=4,this}function Lt(t){return this.buffer.writeFloatBE(t,this.offset+this.position),this.position+=4,this}function Tt(t){return this.buffer.writeDoubleLE(t,this.offset+this.position),this.position+=8,this}function Mt(t){return this.buffer.writeDoubleBE(t,this.offset+this.position),this.position+=8,this}function Bt(t){var r=K(t);return this.writeUInt8(r),St.call(this,t,r,!0)}function St(r,e,i){var n,u,a;if(nt.types[e]){if(!nt.types[e].encode)throw TypeError("Tried to encode a custom type without first defining an encode function.");return this.offset+=this.position,this.position=0,nt.types[e].encode(this,r),this}switch(e){case C:case V:case O:case j:case Y:case P:case G:return this;case x:if(!i&&"string"!=typeof r)throw TypeError("Was expecting a STRING but received a "+o(K(r))+".");return this.writeStringUTF8(r),this;case H:if(!i&&"string"!=typeof r)throw TypeError("Was expecting a STRING but received a "+o(K(r))+".");return this.writeStringUTF16(r),this;case L:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeInt8(r),this;case U:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeUInt8(r),this;case m:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeInt16LE(r),this;case T:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeUInt16LE(r),this;case B:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeInt32LE(r),this;case M:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeUInt32LE(r),this;case S:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeFloatLE(r),this;case A:if(!i&&"number"!=typeof r)throw TypeError("Was expecting a numeric type but received a "+o(K(r))+".");return this.writeDoubleLE(r),this;case F:if(!i&&!tt(r))throw TypeError("Was expecting an ARRAY but received a "+o(K(r))+".");for(Bt.call(this,r.length),n=0;n<r.length;++n)Bt.call(this,r[n]);return this;case N:if(!i&&"object"!=typeof obj)throw TypeError("Was expecting an OBJECT but received a "+o(K(r))+".");for(u=E(r),Bt.call(this,u.length),n=0;n<u.length;++n)this.writeStringUTF8(u[n]),Bt.call(this,r[u[n]]);return this;case _:if(!i&&"[object Date]"!==$.call(r))throw TypeError("Was expecting a DATE but received a "+o(K(r))+".");return this.writeDoubleLE(r.valueOf());case W:if(!i&&!xt(r))throw TypeError("Was expecting a BUFFER but received a "+o(K(r))+".");return Ft.call(this,r);case k:if(!i&&!t(r))throw TypeError("Was expecting a REGEXP but received a "+o(K(r))+".");return a=wt(r),this.writeStringUTF8(a[0]),this.writeUInt8(ft(a[1]));case q:if(!i&&"symbol"!=typeof r)throw TypeError("Was expecting a SYMBOL but received a "+o(K(r))+".");return this.writeStringUTF8(r.toString());case X:if(!(i||r instanceof s))throw TypeError("Was expecting a COMPLEX but received a "+o(K(r))+".");return this.writeDoubleLE(r.r),this.writeDoubleLE(r.i);case J:if(!(i||r instanceof h))throw TypeError("Was expecting a RATIONAL but received a "+o(K(r))+".");return this.writeDoubleLE(r.p),this.writeDoubleLE(r.q)}}function At(t,r){var e;if(r instanceof mt&&(r=r.sorted),void 0===r||r===z)return Bt.call(this,t);if(tt(r)){if(r.object){if("object"!=typeof t)throw TypeError("Was expecting an OBJECT but received a "+o(K(t))+".");for(e=0;e<r.length;++e)this.writeValue(t[r[e].key],r[e].type);return this}if(1===r.length){if(!tt(t))throw TypeError("Was expecting an ARRAY but received a "+o(K(t))+".");for(Bt.call(this,t.length),e=0;e<t.length;++e)this.writeValue(t[e],r[0]);return this}if(!tt(t))throw TypeError("Was expecting an ARRAY but received a "+o(K(t))+".");if(t.length<r.length)throw RangeError("Was expecting an ARRAY with length of at least "+Q(r.length)+" but was provided one of length "+Q(t.length)+".");for(e=0;e<r.length;++e)this.writeValue(t[e],r[e]);return this}return r===R?Bt.call(this,t):St.call(this,t,r)}var Ft;return Ft=f?function(t){var r,e;if(t instanceof ht)for(r=new st(t),this.writeValue(r.length),e=0;e<r.length;++e)this.writeUInt8(r[e]);else if(dt(t))for(this.writeValue(t.length),e=0;e<t.length;++e)this.writeUInt8(t[e]);else"string"==typeof t&&this.writeStringASCII(t)}:l?function(t){var r;if(t instanceof ht)for(r=new st(t),this.writeValue(r.length),i=0;i<r.length;++i)this.writeUInt8(r[i]);else"string"==typeof t&&this.writeStringASCII(t)}:function(t){this.writeStringASCII(t)},function(){this.readUInt8=n,this.readInt8=u,this.readUInt16LE=a,this.readUInt16BE=c,this.readInt16LE=p,this.readInt16BE=d,this.readUInt32LE=w,this.readUInt32BE=b,this.readInt32LE=y,this.readInt32BE=I,this.readFloatLE=v,this.readFloatBE=rt,this.readDoubleLE=et,this.readDoubleBE=it,this.readStringUTF16=function(t){var e,i,n="",s=0;for("number"==typeof t?i=t:(e=this.readUInt8(),r(H,e,this),i=this.readValue(e)),g(this,2*i),s=0;i>s;)n+=Z(this.readUInt16LE()),++s;return n},this.readStringUTF8=function(t){var e,i,n="",s=0;for("number"==typeof t?i=t:(e=this.readUInt8(),r(x,e,this),i=this.readValue(e)),g(this,i);i>s;)n+=Z(this.readUInt8()),++s;return decodeURIComponent(escape(n))},this.readStringASCII=function(t){var e,i,n="",s=0;for("number"==typeof t?i=t:(e=this.readUInt8(),r(D,e,this),i=this.readValue(e)),g(this,i);i>s;)n+=Z(this.readUInt8()),++s;return n},this.readValue=e,this.writeStringUTF8=ot,this.writeStringUTF16=ut,this.writeUInt8=at,this.writeInt8=ct,this.writeUInt16LE=lt,this.writeUInt16BE=pt,this.writeInt16LE=bt,this.writeInt16BE=gt,this.writeUInt32LE=Et,this.writeUInt32BE=yt,this.writeInt32LE=It,this.writeInt32BE=vt,this.writeFloatLE=Ut,this.writeFloatBE=Lt,this.writeDoubleLE=Tt,this.writeDoubleBE=Mt,this.writeValue=At}}();Dt.call(y.prototype);var xt=function(t,r,e){return f?t:l?r:e}(function(t){return dt(t)||t instanceof ht?!0:!1},function(t){return t instanceof ht?!0:!1},function(){return!1}),Rt=function(t,r){return l?t:r}(function(t){return at[0]=t,at[0]===t?S:A},function(t){t=Math.abs(t);var r=Math.log(t)/Math.LN2;r=0>r?Math.ceil(r):Math.floor(r);var e=103+r;return 0>e||e>255?A:(t*=Math.pow(2,-r+24),Math.floor(t)!==t?A:S)}),Vt=function(t,r){return l?t:r}(function(t){var r,e="",i=0;for(t=t.buffer;i<t.byteLength;)r=new st(t,i,Math.min(8192,t.byteLength-i)),e+=Z.apply(void 0,r),i+=8192;return e},function(t){for(var r="",e=0;e<t.length;++e)r+=Z(t[e]);return r}),Ot=function(){function t(){return this.iterator.writeValue(this.payload,this.spec),this}var r,e;return f?(r=function(){for(var t=this.iterator.position+this.iterator.offset,r=new pt(t),e=0;t>e;++e)r[e]=this.iterator.buffer.uchars[e];return r},e=function(t){var r,e;if(t instanceof ht)for(r=new st(t),this.iterator.writeValue(r.length,K(r.length)),e=0;e<r.length;++e)this.iterator.writeValue(r[e],U,!0);else if(dt(t))for(this.iterator.writeValue(t.length,K(t.length)),e=0;e<t.length;++e)this.iterator.writeValue(t[e],U,!1);else"string"==typeof t&&this.writeString(t)}):l?(r=function(){return this.iterator.buffer.buffer},e=function(t){var r;if(t instanceof ht)for(r=new st(t),this.iterator.writeValue(r.length,K(r.length),!0),i=0;i<r.length;++i)this.iterator.writeUInt8(r[i]);else"string"==typeof t&&this.iterator.writeStringASCII(t)}):(r=function(){return Vt(this.buffer.uchars)},e=function(t){this.iterator.writeStringASCII(t)}),function(){this.writeData=t,this.writeBuffer=e,this.toBuffer=r}}();mt.prototype={inspect:function(t,r,e,i,n,s){var h="",u=!1;"undefined"==typeof r&&(r={colors:!1}),"undefined"==typeof s&&(s={}),"undefined"==typeof n&&(h+="{[Channel] ",n=!1,u=!0);var a,f;if("undefined"==typeof e&&(i=0,e=this.spec),"object"==typeof e)if(tt(e))h+="["+this.inspect(t,r,e[0],i,n,s)+"]";else{for(s.flag=!0,h+="{\n",a=rt(e),f=0;f<a.length;++f)h+=Mt("  ",i+1)+Bt(a[f],r.colors)+": "+this.inspect(t,r,e[a[f]],i+1,n,s)+(a.length-1===f?"":",")+"\n";h+=Mt("  ",i)+"}"}else h+=o(e);return u&&(h+="}"),h},encode:function(t){return ot(t,this.sorted).writeData().toBuffer()},decode:function(t){return y(t).readValue(this)}};var jt={};return u(jt)(it),jt.decode=It,jt.encode=vt,jt.toTemplate=yt,jt.BufferIterator=y,jt.Channel=mt,jt.Rational=h,jt.Complex=s,jt.Symbol=bt,jt.defineType=n,jt.noConflict=function(){return I},jt}()});